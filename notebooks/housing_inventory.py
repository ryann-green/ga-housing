# %%
import pandas as pd
import requests
import time
# from creds import *
import os
from sqlalchemy import create_engine
from urllib.parse import quote
from io import StringIO
from creds import pw



data_types=["For-Sale Inventory (Smooth, All Homes, Monthly)","For-Sale Inventory (Smooth, All Homes, Weekly)","For-Sale Inventory (Raw, All Homes, Monthly)","For-Sale Inventory (Raw, All Homes, Weekly)","New Listings (Smooth, All Homes, Monthly)","New Listings (Smooth, All Homes, Weekly)","New Listings (Raw, All Homes, Monthly)","New Listings (Raw, All Homes, Weekly)","Newly Pending Listings (Raw, All Homes, Monthly)","Newly Pending Listings (Raw, All Homes, Weekly) ","Newly Pending Listings (Smoothed, All Homes, Monthly)","Newly Pending Listings (Smoothed, All Homes, Weekly)"]
geographies=["Metro & U.S.","Metro & U.S. "]
data = {"HOME VALUES":{"ZHVI All Homes (SFR, Condo\/Co-op) Time Series, Smoothed, Seasonally Adjusted($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Zip_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","Neighborhood":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Neighborhood_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395"},"ZHVI All Homes (SFR, Condo\/Co-op) Time Series, Raw, Mid-Tier ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_uc_sfrcondo_tier_0.33_0.67_month.csv?t=1671682395"},"ZHVI All Homes- Top Tier Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_uc_sfrcondo_tier_0.67_1.0_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_uc_sfrcondo_tier_0.67_1.0_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_uc_sfrcondo_tier_0.67_1.0_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_uc_sfrcondo_tier_0.67_1.0_sm_sa_month.csv?t=1671682395"},"ZHVI All Homes- Bottom Tier Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_uc_sfrcondo_tier_0.0_0.33_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_uc_sfrcondo_tier_0.0_0.33_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_uc_sfrcondo_tier_0.0_0.33_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_uc_sfrcondo_tier_0.0_0.33_sm_sa_month.csv?t=1671682395"},"ZHVI Single-Family Homes Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Zip_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","Neighborhood":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Neighborhood_zhvi_uc_sfr_sm_sa_month.csv?t=1671682395"},"ZHVI Condo\/Co-op Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_uc_condo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_uc_condo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_uc_condo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_uc_condo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Zip_zhvi_uc_condo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","Neighborhood":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Neighborhood_zhvi_uc_condo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395"},"ZHVI 1-Bedroom Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_bdrmcnt_1_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_bdrmcnt_1_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_bdrmcnt_1_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_bdrmcnt_1_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Zip_zhvi_bdrmcnt_1_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","Neighborhood":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Neighborhood_zhvi_bdrmcnt_1_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395"},"ZHVI 2-Bedroom Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_bdrmcnt_2_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_bdrmcnt_2_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_bdrmcnt_2_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_bdrmcnt_2_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Zip_zhvi_bdrmcnt_2_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","Neighborhood":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Neighborhood_zhvi_bdrmcnt_2_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395"},"ZHVI 3-Bedroom Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_bdrmcnt_3_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_bdrmcnt_3_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_bdrmcnt_3_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_bdrmcnt_3_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Zip_zhvi_bdrmcnt_3_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","Neighborhood":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Neighborhood_zhvi_bdrmcnt_3_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395"},"ZHVI 4-Bedroom Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_bdrmcnt_4_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_bdrmcnt_4_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_bdrmcnt_4_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_bdrmcnt_4_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Zip_zhvi_bdrmcnt_4_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","Neighborhood":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Neighborhood_zhvi_bdrmcnt_4_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395"},"ZHVI 5+ Bedroom Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Metro_zhvi_bdrmcnt_5_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","State":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/State_zhvi_bdrmcnt_5_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/County_zhvi_bdrmcnt_5_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/City_zhvi_bdrmcnt_5_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Zip_zhvi_bdrmcnt_5_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","Neighborhood":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvi\/Neighborhood_zhvi_bdrmcnt_5_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395"}},"HOME VALUES FORECASTS":{"ZHVF (Forecast), All Homes (SFR, Condo\/Co-op), Smoothed, Seasonally Adjusted, Mid-Tier (MoM%, QoQ%, YoY%)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvf_growth\/Metro_zhvf_growth_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvf_growth\/Zip_zhvf_growth_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1671682395"},"ZHVF (Forecast), All Homes (SFR, Condo\/Co-op), Raw, Mid-Tier (MoM%, QoQ%, YoY%)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvf_growth\/Metro_zhvf_growth_uc_sfrcondo_tier_0.33_0.67_month.csv?t=1671682395","ZIP Code":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zhvf_growth\/Zip_zhvf_growth_uc_sfrcondo_tier_0.33_0.67_month.csv?t=1671682395"}},"RENTALS":{"ZORI (Smoothed): All Homes Plus Multifamily Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zori\/Metro_zori_sm_month.csv?t=1671682395","ZIP Codes":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zori\/Zip_zori_sm_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zori\/County_zori_sm_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zori\/City_zori_sm_month.csv?t=1671682395"},"ZORI (Smoothed, Seasonally Adjusted): All Homes Plus Multifamily Time Series ($)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zori\/Metro_zori_sm_sa_month.csv?t=1671682395","ZIP Codes":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zori\/Zip_zori_sm_sa_month.csv?t=1671682395","County":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zori\/County_zori_sm_sa_month.csv?t=1671682395","City":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/zori\/City_zori_sm_sa_month.csv?t=1671682395"}},"INVENTORY":{"For-Sale Inventory (Smooth, All Homes, Monthly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/invt_fs\/Metro_invt_fs_uc_sfrcondo_sm_month.csv?t=1671682395"},"For-Sale Inventory (Smooth, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/invt_fs\/Metro_invt_fs_uc_sfrcondo_sm_week.csv?t=1671682395"},"For-Sale Inventory (Smooth, SFR Only, Monthly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/invt_fs\/Metro_invt_fs_uc_sfr_sm_month.csv?t=1671682395"},"For-Sale Inventory (Smooth, SFR Only, Weekly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/invt_fs\/Metro_invt_fs_uc_sfr_sm_week.csv?t=1671682395"},"For-Sale Inventory (Raw, All Homes, Monthly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/invt_fs\/Metro_invt_fs_uc_sfrcondo_month.csv?t=1671682395"},"For-Sale Inventory (Raw, All Homes, Weekly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/invt_fs\/Metro_invt_fs_uc_sfrcondo_week.csv?t=1671682395"},"For-Sale Inventory (Raw, SFR Only, Monthly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/invt_fs\/Metro_invt_fs_uc_sfr_month.csv?t=1671682395"},"For-Sale Inventory (Raw, SFR Only, Weekly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/invt_fs\/Metro_invt_fs_uc_sfr_week.csv?t=1671682395"},"New Listings (Smooth, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/new_listings\/Metro_new_listings_uc_sfrcondo_sm_month.csv?t=1671682395"},"New Listings (Smooth, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/new_listings\/Metro_new_listings_uc_sfrcondo_sm_week.csv?t=1671682395"},"New Listings (Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/new_listings\/Metro_new_listings_uc_sfrcondo_month.csv?t=1671682395"},"New Listings (Raw, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/new_listings\/Metro_new_listings_uc_sfrcondo_week.csv?t=1671682395"},"Newly Pending Listings (Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/new_pending\/Metro_new_pending_uc_sfrcondo_month.csv?t=1671682395"},"Newly Pending Listings (Raw, All Homes, Weekly) ":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/new_pending\/Metro_new_pending_uc_sfrcondo_week.csv?t=1671682395"},"Newly Pending Listings (Smoothed, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/new_pending\/Metro_new_pending_uc_sfrcondo_sm_month.csv?t=1671682395"},"Newly Pending Listings (Smoothed, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/new_pending\/Metro_new_pending_uc_sfrcondo_sm_week.csv?t=1671682395"},"Mean Days to Pending (Smooth, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_doz_pending\/Metro_mean_doz_pending_uc_sfrcondo_sm_month.csv?t=1671682395"},"Mean Days to Pending (Smooth, All Homes, Weekly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_doz_pending\/Metro_mean_doz_pending_uc_sfrcondo_sm_week.csv?t=1671682395"},"Mean Days to Pending (Raw, All Homes, Monthly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_doz_pending\/Metro_mean_doz_pending_uc_sfrcondo_month.csv?t=1671682395"},"Mean Days to Pending (Raw, All Homes, Weekly) ":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_doz_pending\/Metro_mean_doz_pending_uc_sfrcondo_week.csv?t=1671682395"},"Median Days to Pending (Smooth, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_doz_pending\/Metro_med_doz_pending_uc_sfrcondo_sm_month.csv?t=1671682395"},"Median Days to Pending (Smooth, All Homes, Weekly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_doz_pending\/Metro_med_doz_pending_uc_sfrcondo_sm_week.csv?t=1671682395"},"Median Days to Pending (Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_doz_pending\/Metro_med_doz_pending_uc_sfrcondo_month.csv?t=1671682395"},"Median Days to Pending (Raw, All Homes, Weekly)":{"Metro & U.S. ":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_doz_pending\/Metro_med_doz_pending_uc_sfrcondo_week.csv?t=1671682395"}},"LIST AND SALE PRICES":{"Median List Price (Smooth, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mlp\/Metro_mlp_uc_sfrcondo_sm_month.csv?t=1671682395"},"Median List Price (Smooth, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mlp\/Metro_mlp_uc_sfrcondo_sm_week.csv?t=1671682395"},"Median List Price (Smooth, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mlp\/Metro_mlp_uc_sfr_sm_month.csv?t=1671682395"},"Median List Price (Smooth, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mlp\/Metro_mlp_uc_sfr_sm_week.csv?t=1671682395"},"Median List Price (Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mlp\/Metro_mlp_uc_sfrcondo_month.csv?t=1671682395"},"Median List Price (Raw, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mlp\/Metro_mlp_uc_sfrcondo_week.csv?t=1671682395"},"Median List Price (Raw, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mlp\/Metro_mlp_uc_sfr_month.csv?t=1671682395"},"Median List Price (Raw, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mlp\/Metro_mlp_uc_sfr_week.csv?t=1671682395"},"Median Sale Price (Smooth & Seasonally Adjusted, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfrcondo_sm_sa_month.csv?t=1671682395"},"Median Sale Price (Smooth & Seasonally Adjusted, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfrcondo_sm_sa_week.csv?t=1671682395"},"Median Sale Price (Smooth, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfrcondo_sm_month.csv?t=1671682395"},"Median Sale Price (Smooth, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfrcondo_sm_week.csv?t=1671682395"},"Median Sale Price (Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfrcondo_month.csv?t=1671682395"},"Median Sale Price (Raw, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfrcondo_week.csv?t=1671682395"},"Median Sale Price (Smooth & Seasonally Adjusted, SFR only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_v2\/median_sale_price\/Metro_median_sale_price_uc_SFR_sm_sa_month.csv?t=1671682395"},"Median Sale Price (Smooth & Seasonally Adjusted, SFR only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfr_sm_sa_week.csv?t=1671682395"},"Median Sale Price (Smooth, SFR only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfr_sm_month.csv?t=1671682395"},"Median Sale Price (Smooth, SFR only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfr_sm_week.csv?t=1671682395"},"Median Sale Price (Raw, SFR only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfr_month.csv?t=1671682395"},"Median Sale Price (Raw, SFR only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_price\/Metro_median_sale_price_uc_sfr_week.csv?t=1671682395"},"Mean Sale-to-List Ratio (Raw, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_sale_to_list\/Metro_mean_sale_to_list_uc_sfrcondo_month.csv?t=1671682395"},"Mean Sale-to-List Ratio (Smooth, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_sale_to_list\/Metro_mean_sale_to_list_uc_sfrcondo_sm_month.csv?t=1671682395"},"Mean Sale-to-List Ratio (Raw, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_sale_to_list\/Metro_mean_sale_to_list_uc_sfrcondo_week.csv?t=1671682395"},"Mean Sale-to-List Ratio (Smooth, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_sale_to_list\/Metro_mean_sale_to_list_uc_sfrcondo_sm_week.csv?t=1671682395"},"Median Sale-to-List Ratio (Raw, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_to_list\/Metro_median_sale_to_list_uc_sfrcondo_month.csv?t=1671682395"},"Median Sale-to-List Ratio (Smooth, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_to_list\/Metro_median_sale_to_list_uc_sfrcondo_sm_month.csv?t=1671682395"},"Median Sale-to-List Ratio (Raw, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_to_list\/Metro_median_sale_to_list_uc_sfrcondo_week.csv?t=1671682395"},"Median Sale-to-List Ratio (Smooth, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_sale_to_list\/Metro_median_sale_to_list_uc_sfrcondo_sm_week.csv?t=1671682395"},"Percent of Homes Sold Above List (Raw, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/pct_sold_above_list\/Metro_pct_sold_above_list_uc_sfrcondo_month.csv?t=1671682395"},"Percent of Homes Sold Above List (Smooth, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/pct_sold_above_list\/Metro_pct_sold_above_list_uc_sfrcondo_sm_month.csv?t=1671682395"},"Percent of Homes Sold Above List (Raw, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/pct_sold_above_list\/Metro_pct_sold_above_list_uc_sfrcondo_week.csv?t=1671682395"},"Percent of Homes Sold Above List (Smooth, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/pct_sold_above_list\/Metro_pct_sold_above_list_uc_sfrcondo_sm_week.csv?t=1671682395"},"Percent of Homes Sold Below List (Raw, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/pct_sold_below_list\/Metro_pct_sold_below_list_uc_sfrcondo_month.csv?t=1671682395"},"Percent of Homes Sold Below List (Smooth, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/pct_sold_below_list\/Metro_pct_sold_below_list_uc_sfrcondo_sm_month.csv?t=1671682395"},"Percent of Homes Sold Below List (Raw, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/pct_sold_below_list\/Metro_pct_sold_below_list_uc_sfrcondo_week.csv?t=1671682395"},"Percent of Homes Sold Below List (Smooth, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/pct_sold_below_list\/Metro_pct_sold_below_list_uc_sfrcondo_sm_week.csv?t=1671682395"},"Mean Days to Close (Raw, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_days_to_close\/Metro_mean_days_to_close_uc_sfrcondo_month.csv?t=1671682395"},"Mean Days to Close (Smooth, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_days_to_close\/Metro_mean_days_to_close_uc_sfrcondo_sm_month.csv?t=1671682395"},"Mean Days to Close (Raw, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_days_to_close\/Metro_mean_days_to_close_uc_sfrcondo_week.csv?t=1671682395"},"Mean Days to Close (Smooth, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_days_to_close\/Metro_mean_days_to_close_uc_sfrcondo_sm_week.csv?t=1671682395"},"Median Days to Close (Raw, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_days_to_close\/Metro_median_days_to_close_uc_sfrcondo_month.csv?t=1671682395"},"Median Days to Close (Smooth, All Homes, Monthly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_days_to_close\/Metro_median_days_to_close_uc_sfrcondo_sm_month.csv?t=1671682395"},"Median Days to Close (Raw, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_days_to_close\/Metro_median_days_to_close_uc_sfrcondo_week.csv?t=1671682395"},"Median Days to Close (Smooth, All Homes, Weekly View)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/median_days_to_close\/Metro_median_days_to_close_uc_sfrcondo_sm_week.csv?t=1671682395"}},"SALES COUNT AND PRICE CUTS":{"Sales Count Nowcast (Raw, All Homes)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/sales_count_now\/Metro_sales_count_now_uc_sfrcondo_month.csv?t=1671682395"},"Share of Listings With a Price Cut (Smooth, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/perc_listings_price_cut\/Metro_perc_listings_price_cut_uc_sfrcondo_sm_month.csv?t=1671682395"},"Share of Listings With a Price Cut (Smooth, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/perc_listings_price_cut\/Metro_perc_listings_price_cut_uc_sfrcondo_sm_week.csv?t=1671682395"},"Share of Listings With a Price Cut (Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/perc_listings_price_cut\/Metro_perc_listings_price_cut_uc_sfrcondo_month.csv?t=1671682395"},"Share of Listings With a Price Cut (Raw, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/perc_listings_price_cut\/Metro_perc_listings_price_cut_uc_sfrcondo_week.csv?t=1671682395"},"Share of Listings With a Price Cut (Smooth, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/perc_listings_price_cut\/Metro_perc_listings_price_cut_uc_sfr_sm_month.csv?t=1671682395"},"Share of Listings With a Price Cut (Smooth, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/perc_listings_price_cut\/Metro_perc_listings_price_cut_uc_sfr_sm_week.csv?t=1671682395"},"Share of Listings With a Price Cut (Raw, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/perc_listings_price_cut\/Metro_perc_listings_price_cut_uc_sfr_month.csv?t=1671682395"},"Share of Listings With a Price Cut (Raw, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/perc_listings_price_cut\/Metro_perc_listings_price_cut_uc_sfr_week.csv?t=1671682395"},"Mean Price Cut ($, Raw, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_amt\/Metro_mean_listings_price_cut_amt_uc_sfr_month.csv?t=1671682395"},"Mean Price Cut ($, Raw, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_amt\/Metro_mean_listings_price_cut_amt_uc_sfr_week.csv?t=1671682395"},"Mean Price Cut ($, Smoothed, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_amt\/Metro_mean_listings_price_cut_amt_uc_sfr_sm_month.csv?t=1671682395"},"Mean Price Cut ($, Smoothed, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_amt\/Metro_mean_listings_price_cut_amt_uc_sfr_sm_week.csv?t=1671682395"},"Mean Price Cut ($, Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_amt\/Metro_mean_listings_price_cut_amt_uc_sfrcondo_month.csv?t=1671682395"},"Mean Price Cut ($, Raw, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_amt\/Metro_mean_listings_price_cut_amt_uc_sfrcondo_week.csv?t=1671682395"},"Mean Price Cut ($, Smoothed, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_amt\/Metro_mean_listings_price_cut_amt_uc_sfrcondo_sm_month.csv?t=1671682395"},"Mean Price Cut ($, Smoothed, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_amt\/Metro_mean_listings_price_cut_amt_uc_sfrcondo_sm_week.csv?t=1671682395"},"Mean Price Cut (%, Raw, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_v2\/mean_listings_price_cut_perc\/Metro_mean_listings_price_cut_perc_uc_sfr_smoothed_month.csv?t=1671682395"},"Mean Price Cut (%, Raw, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_v2\/mean_listings_price_cut_perc\/Metro_mean_listings_price_cut_perc_uc_sfr_smoothed_week.csv?t=1671682395"},"Mean Price Cut (%, Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_perc\/Metro_mean_listings_price_cut_perc_uc_sfrcondo_month.csv?t=1671682395"},"Mean Price Cut (%, Raw, All Homes, Weeky)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_perc\/Metro_mean_listings_price_cut_perc_uc_sfrcondo_week.csv?t=1671682395"},"Mean Price Cut (%, Smoothed, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_perc\/Metro_mean_listings_price_cut_perc_uc_sfrcondo_sm_month.csv?t=1671682395"},"Mean Price Cut (%, Smoothed, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/mean_listings_price_cut_perc\/Metro_mean_listings_price_cut_perc_uc_sfrcondo_sm_week.csv?t=1671682395"},"Median Price Cut ($, Raw, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_amt\/Metro_med_listings_price_cut_amt_uc_sfr_month.csv?t=1671682395"},"Median Price Cut ($, Raw, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_amt\/Metro_med_listings_price_cut_amt_uc_sfr_week.csv?t=1671682395"},"Median Price Cut ($, Smoothed, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_amt\/Metro_med_listings_price_cut_amt_uc_sfr_sm_month.csv?t=1671682395"},"Median Price Cut ($, Smoothed, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_amt\/Metro_med_listings_price_cut_amt_uc_sfr_sm_week.csv?t=1671682395"},"Median Price Cut ($, Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_amt\/Metro_med_listings_price_cut_amt_uc_sfrcondo_month.csv?t=1671682395"},"Median Price Cut ($, Raw, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_amt\/Metro_med_listings_price_cut_amt_uc_sfrcondo_week.csv?t=1671682395"},"Median Price Cut ($, Smoothed, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_amt\/Metro_med_listings_price_cut_amt_uc_sfrcondo_sm_month.csv?t=1671682395"},"Median Price Cut ($, Smoothed, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_amt\/Metro_med_listings_price_cut_amt_uc_sfrcondo_sm_week.csv?t=1671682395"},"Median Price Cut (%, Raw, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_perc\/Metro_med_listings_price_cut_perc_uc_sfr_month.csv?t=1671682395"},"Median Price Cut (%, Raw, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_perc\/Metro_med_listings_price_cut_perc_uc_sfr_week.csv?t=1671682395"},"Median Price Cut (%, Smoothed, SFR Only, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_perc\/Metro_med_listings_price_cut_perc_uc_sfr_sm_month.csv?t=1671682395"},"Median Price Cut (%, Smoothed, SFR Only, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_perc\/Metro_med_listings_price_cut_perc_uc_sfr_sm_week.csv?t=1671682395"},"Median Price Cut (%, Raw, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_perc\/Metro_med_listings_price_cut_perc_uc_sfrcondo_month.csv?t=1671682395"},"Median Price Cut (%, Raw, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_perc\/Metro_med_listings_price_cut_perc_uc_sfrcondo_week.csv?t=1671682395"},"Median Price Cut (%, Smoothed, All Homes, Monthly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_perc\/Metro_med_listings_price_cut_perc_uc_sfrcondo_sm_month.csv?t=1671682395"},"Median Price Cut (%, Smoothed, All Homes, Weekly)":{"Metro & U.S.":"https:\/\/files.zillowstatic.com\/research\/public_csvs\/med_listings_price_cut_perc\/Metro_med_listings_price_cut_perc_uc_sfrcondo_sm_week.csv?t=1671682395"}}}

# d=["family","condo","3-bdr","4-bdr"]
# import pprint
# from pprint import PrettyPrinter as pp

# pprint.pprint(data['HOME VALUES'])
i=0
housing_data=[]
for item in data_types:
    g=0
    for geography in geographies:
        row={}
        if geography in data["INVENTORY"][item]:
            row['data_type']=item.replace('\\', '').replace('($)', '').replace('/', '_')
            row['geography']=geography
            row['url']=data["INVENTORY"][item][geography].replace('\\', '')
            # row['g_sheet']=f"{d[i]}_{geographies[g]}"
        
            housing_data.append(row)
        # else:
        #     print(f"Missing data for {item} in {geography}")
        g+=1
    i+=1

data_df=pd.DataFrame(housing_data)
data_df.to_csv('ga-housing/outputs/map/inventory_data_map.csv')
data_df

# %%
urls=data_df["url"]
file_names=[]
files=[]

    
for i,row in data_df.iterrows():
    # print(row)
   
    req=requests.get(row["url"])
    
    url_content=req.content
    # print(url_content)
    
    s=str(url_content,'utf-8')

    data = StringIO(s) 

    df=pd.read_csv(data)

    file_name=f"{row['data_type']}_{row['geography']}"
    
    files.append({"file_name": file_name, "data": df})
    
    print(f"Added {file_name} to list")


def add_table(df,table):

    # script to create sql database for needed tables
    engine = create_engine(f'mysql+pymysql://admin:{pw}@database1.cx3lr0rjdt4v.us-east-2.rds.amazonaws.com/housing')
    df.to_sql(f"{table}",con=engine, if_exists='replace')

dfs=[]
i=0
for file in files:
#     read the file from the directory
    df=file['data']    
#     group the columns I want to prepare for pivot
    other_cols=list(df[df.columns[~df.columns.isin(['RegionID','SizeRank','RegionName','RegionType','StateName','State','Metro','StateCodeFIPS','MunicipalCodeFIPS','CountyName','City'])]].columns)
    pivot_cols=list(df[df.columns[df.columns.isin(['RegionID','SizeRank','RegionName','RegionType','StateName','State','Metro'])]].columns)
    ["','".join(pivot_cols)]
    
#   pivot the columns and give it a new alias
    full_data=pd.melt(df,id_vars=pivot_cols,value_vars=other_cols,var_name='Date',value_name='Inventory')
    
#     add an identifier for the type of data represented
    full_data['type']=file['file_name']


    # add_table(full_data.loc[full_data['Date']>='2021-01-01'],file)
    print(f"Added {file['file_name']} to 'formatted' directory")
    
#     append the dataframe to our list for full file merging later
    dfs.append(full_data.loc[full_data['Date']>='2021-01-01'])

    
    i+=i

# %%
data_concat = pd.concat(dfs,             
                      ignore_index = True,
                      sort = False)

# data_concat.to_csv("ga-housing/outputs/formatted/inventory/housing_inventory.csv",index=False)



add_table(data_concat,"housing_inventory")

print("Added inventory table to database")



